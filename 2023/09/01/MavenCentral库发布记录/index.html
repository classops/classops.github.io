<!DOCTYPE html><html class="appearance-auto" lang="zh-CN"><head><meta charset="UTF-8"><title>MavenCentral库发布记录</title><meta name="description" content="class ops"><meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no, initial-scale=1"><!-- Google Analytics --><!-- End Google Analytics -->
<!-- Baidu Analytics --><!-- End Baidu Analytics --><link rel="icon" href="/images/favicon.ico"><link rel="stylesheet" href="/style/common/bulma.css"><link rel="stylesheet" href="/style/base.css"><link rel="stylesheet" href="/style/common/helper.css"><script src="/js/common.js"></script><link rel="stylesheet" href="/style/post.css"><link rel="stylesheet" href="/style/themes/highlight-theme-light.css"><link rel="stylesheet" href="/style/common/jquery.fancybox.min.css"><script src="/js/highlight.pack.js"></script><meta name="description" content="MavenCentral库发布记录一、注册 Sonatype 账号，新建项目注册https:&amp;#x2F;&amp;#x2F;​​issues.sonatype.org
登录后，新建项目：
相关选项，选择：

项目：Community Support - Open Source Project - Repository Hosting (OSSRH)  
类型：New Project  
概要：填写 Git 项目名即可  
Group Id: Github项目，io.github.xxx 用户名  
Project URL: 填写 github 项目主页  
SCM url: 填 github项目地址 + .git


点击提交后，等待 3-5分钟 回复，验证 github 所有权。

在自己项目里，在 github.."><meta name="generator" content="Hexo 6.3.0"></head><body class="is-flex is-flex-direction-column"><header class="header-widget is-flex-shrink-0 is-hidden-mobile"><div class="container is-fullhd is-flex is-justify-content-space-between is-align-items-center is-full-height"><section class="is-hidden-mobile is-flex-shrink-0"><h2><a href="/">ClassOps's blog</a></h2></section><h3 class="is-hidden-mobile is-family-serif is-full-height is-flex is-align-items-center is-flex-shrink-0"><div class="is-full-height" id="postTopic"><p class="is-full-height is-flex-shrink-0 is-flex is-align-items-center is-justify-content-center">MavenCentral库发布记录</p><p class="is-full-height is-flex-shrink-0 is-flex is-align-items-center is-justify-content-center">点击返回顶部</p></div></h3><aside class="is-flex-shrink-0"><h3 class="is-inline-block"><a href="/">首页</a></h3><h3 class="is-inline-block"><a href="/about">关于</a></h3><h3 class="is-inline-block"><a href="/archives">归档</a></h3></aside></div></header><header class="is-flex header-widget is-flex-shrink-0 is-align-items-center is-justify-content-center is-hidden-tablet"><h3 class="is-inline-block"><a href="/">首页</a></h3><h3 class="is-inline-block"><a href="/about">关于</a></h3><h3 class="is-inline-block"><a href="/archives">归档</a></h3></header><main><main class="container is-max-widescreen content section post-page pt-4 px-4"><div class="columns is-flex-desktop is-justify-content-center is-flex-direction-row-reverse"><div class="column is-3 is-hidden-mobile"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#MavenCentral%E5%BA%93%E5%8F%91%E5%B8%83%E8%AE%B0%E5%BD%95"><span class="toc-text">MavenCentral库发布记录</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%80%E3%80%81%E6%B3%A8%E5%86%8C-Sonatype-%E8%B4%A6%E5%8F%B7%EF%BC%8C%E6%96%B0%E5%BB%BA%E9%A1%B9%E7%9B%AE"><span class="toc-text">一、注册 Sonatype 账号，新建项目</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%8C%E3%80%81%E5%87%86%E5%A4%87-GPG-%E5%AF%86%E9%92%A5"><span class="toc-text">二、准备 GPG 密钥</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%89%E3%80%81Gradle%E9%A1%B9%E7%9B%AE%E9%85%8D%E7%BD%AE"><span class="toc-text">三、Gradle项目配置</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%85%8D%E7%BD%AE%E5%8F%91%E5%B8%83"><span class="toc-text">配置发布</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%85%8D%E7%BD%AE-sonatype-%E8%B4%A6%E5%8F%B7-%E5%92%8C-GPG%E5%AF%86%E9%92%A5"><span class="toc-text">配置 sonatype 账号 和 GPG密钥</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9B%9B%E3%80%81%E5%8F%91%E5%B8%83%E5%88%B0%E4%BB%93%E5%BA%93"><span class="toc-text">四、发布到仓库</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%87%E6%A1%A3"><span class="toc-text">文档</span></a></li></ol></li></ol></div><div class="column is-9"><header class="my-4"></header><h1 class="mt-0 mb-1 is-family-serif" id="postTitle">MavenCentral库发布记录</h1><time class="has-text-grey" datetime="2023-09-01T01:53:11.000Z">2023-09-01</time><article class="mt-2 post-content"><h2 id="MavenCentral库发布记录"><a href="#MavenCentral库发布记录" class="headerlink" title="MavenCentral库发布记录"></a>MavenCentral库发布记录</h2><h3 id="一、注册-Sonatype-账号，新建项目"><a href="#一、注册-Sonatype-账号，新建项目" class="headerlink" title="一、注册 Sonatype 账号，新建项目"></a>一、注册 Sonatype 账号，新建项目</h3><p><strong>注册</strong><br>https:&#x2F;&#x2F;​​issues.sonatype.org</p>
<p><strong>登录后，新建项目：</strong></p>
<p>相关选项，选择：</p>
<ul>
<li><strong>项目</strong>：Community Support - Open Source Project - Repository Hosting (OSSRH)  </li>
<li><strong>类型</strong>：New Project  </li>
<li><strong>概要</strong>：填写 Git 项目名即可  </li>
<li><strong>Group Id</strong>: Github项目，io.github.xxx 用户名  </li>
<li><strong>Project URL</strong>: 填写 github 项目主页  </li>
<li><strong>SCM url</strong>: 填 github项目地址 + .git</li>
</ul>
<p><img src="/images/sona1.png" alt="新建"><br><img src="/./images/sona2.png" alt="新建"></p>
<p><strong>点击提交后，等待 3-5分钟 回复，验证 github 所有权。</strong></p>
<ul>
<li>在自己项目里，在 github 创建 回复的 仓库</li>
<li>创建完成后，回复评论，大概意思就是即可： 仓库已创建</li>
</ul>
<p><img src="/./images/sona3.png" alt="回复"></p>
<p><strong>等待5-10分钟后，验证成功</strong></p>
<p>这时候，就有上传到 sonatype nexus 仓库权限了</p>
<h3 id="二、准备-GPG-密钥"><a href="#二、准备-GPG-密钥" class="headerlink" title="二、准备 GPG 密钥"></a>二、准备 GPG 密钥</h3><p>GPG 来生成 密钥，安装 GPG<br>Windows下使用scoop安装：</p>
<pre><code>scoop install gpg

gpg --generate-key

gpg --list-keys
</code></pre>
<p>这里获取到pub公钥，</p>
<p><img src="/./images/GPG.png" alt="GPG"></p>
<p>创建完成，–list-keys 显示 pub 第二方 一串：<br>67E95C8F2931C822********************F7E9<br>后面用于 <strong>上传和验证 公钥</strong></p>
<p><strong>上传公钥</strong></p>
<pre><code>gpg --keyserver hkp://keyserver.ubuntu.com:11371 --send-keys 
67E95C8F2931C822********************F7E9

# 验证是否上传功能，后 8 位即可
gpg --keyserver hkp://keyserver.ubuntu.com:11371 --recv-keys ****F7E9
</code></pre>
<p><strong>导出密钥，后面签名用</strong></p>
<pre><code>gpg --export-secret-keys 67E95C8F2931C822********************F7E9 &gt; secret.gpg
</code></pre>
<h3 id="三、Gradle项目配置"><a href="#三、Gradle项目配置" class="headerlink" title="三、Gradle项目配置"></a>三、Gradle项目配置</h3><p>本地发布和远程发布，需要 maven-publish 插件，<br>GPG为了签名，需要 signing 插件。项目模块 build.gradle 配置：</p>
<pre><code class="groovy">plugins &#123;
    id &#39;maven-publish&#39;
    id &#39;signing&#39;
&#125;
</code></pre>
<p>添加后，gradle 就多了 publish 任务：</p>
<p><img src="/./images/gradle-publish-task.png" alt="publish"></p>
<h4 id="配置发布"><a href="#配置发布" class="headerlink" title="配置发布"></a>配置发布</h4><p>添加maven-publish后，开始配置 publishing 代码块</p>
<pre><code class="groovy">// 配置发布后 groupId，默认 artifactId 是项目模块名
group = &#39;org.example&#39;
version = &#39;1.0&#39;

task sourcesJar(type: Jar) &#123;
    classifier = &#39;sources&#39;
    from sourceSets.main.allSource
&#125;

task javadocJar(type: Jar) &#123;
    classifier = &#39;javadoc&#39;
    from javadoc.destinationDir
&#125;

publishing &#123;
    publications &#123;
        release(MavenPublication) &#123;
            // 配置POM信息
            pom &#123;
                name = project.name
                description = &#39;xxx&#39;
                url = &#39;https://github.com/xxx/xxx&#39;
                // 开源协议
                licenses &#123;
                    license &#123;
                        name = &#39;The Apache License, Version 2.0&#39;
                        url = &#39;http://www.apache.org/licenses/LICENSE-2.0.txt&#39;
                    &#125;
                &#125;

                // 配置开发者信息
                developers &#123;
                    developer &#123;
                        id = &#39;xxx&#39;
                        name = &#39;xxx&#39;
                        email = &#39;xxx@163.com&#39;
                    &#125;
                &#125;

                // scm
                scm &#123;
                    connection = &#39;https://github.com/xxx/xxx.git&#39;
                    developerConnection = &#39;https://github.com/xxx/xxx.git&#39;
                    url = &#39;https://github.com/xxx/xxx&#39;
                &#125;
            &#125;

            // 发布文档 JAR
            artifact javadocJar
            // 发布源码 JAR
            artifact sourcesJar

            from components.java
        &#125;
    &#125;

    repositories &#123;
        maven &#123;
            url &quot;https://s01.oss.sonatype.org/service/local/staging/deploy/maven2/&quot;
            credentials &#123;                
                username project.sonaUsername // sonatype username
                password project.sonaPassword // sonatype password
            &#125;
        &#125;
    &#125;
&#125;

signing &#123;
    sign publishing.publications.release
&#125;
</code></pre>
<h4 id="配置-sonatype-账号-和-GPG密钥"><a href="#配置-sonatype-账号-和-GPG密钥" class="headerlink" title="配置 sonatype 账号 和 GPG密钥"></a>配置 sonatype 账号 和 GPG密钥</h4><p>上面配置，还不能直接使用，在 gradle.properties 配置用到的 变量：</p>
<p>对于密码信息，可以放到 用户目录下的 gradle.properties，<br>Windows下是：</p>
<pre><code>C:\Users\用户名\.gradle\gradle.properties
</code></pre>
<p>添加 账号信息：</p>
<pre><code class="properties"># sonatype 账号信息
sonaUsername=xxxx
sonaPassword=xxxx
# GPG Signing Info
signing.keyId=XXXXXXXX
signing.password=xxxxxx
# 上面导出的 GPG 密钥路径
signing.secretKeyRingFile=C:\\Users\\username\\.gpg\\secret.gpg
</code></pre>
<h3 id="四、发布到仓库"><a href="#四、发布到仓库" class="headerlink" title="四、发布到仓库"></a>四、发布到仓库</h3><p>项目下执行命令进行发布：</p>
<pre><code class="bat">.\gradlew.bat publish
</code></pre>
<p>发布成功后，进入 snoatype nexus 后台，管理发布：<br><a target="_blank" rel="noopener" href="https://s01.oss.sonatype.org/#stagingRepositories">https://s01.oss.sonatype.org/#stagingRepositories</a></p>
<ol>
<li>在 Staging Repositories，勾选发布的仓库，点击Close并确定</li>
<li>稍等几分钟，验证通过，点 Release</li>
<li>10-30分钟后，会在 Maven Central 同步更新</li>
</ol>
<ul>
<li>可在 <a target="_blank" rel="noopener" href="https://mvnrepository.com/">https://mvnrepository.com/</a> 搜索查看库</li>
</ul>
<h3 id="文档"><a href="#文档" class="headerlink" title="文档"></a>文档</h3><ul>
<li>Android 发布: <a target="_blank" rel="noopener" href="https://developer.android.com/build/publish-library/upload-library">https://developer.android.com/build/publish-library/upload-library</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.51cto.com/u_12853553/5896541">https://blog.51cto.com/u_12853553/5896541</a></li>
</ul>
</article><section class="jump-container is-flex is-justify-content-space-between my-6"><!-- em is empty placeholder--><em></em></section></div></div></main></main><footer class="is-flex is-flex-direction-column is-align-items-center is-flex-shrink-0 is-family-serif"><section class="sns-container"><!-- Github--><a title="github" target="_blank" rel="noopener nofollow" href="//github.com/classops"><i class="iconfont icon-github"></i></a><!-- Ins--><!-- RSS--><!-- 知乎--><!-- 领英--><!-- 脸书--></section><p><span>Copyright ©</span><span> ClassOps 2023</span></p><div class="is-flex is-justify-content-center is-flex-wrap-wrap"><p>Powered by Hexo &verbar;&nbsp;</p><p class="is-flex is-justify-content-center"><a title="Hexo theme author" target="_blank" rel="noopener" href="//github.com/haojen">Theme by Haojen&nbsp;</a></p><div style="margin-top: 2px"><a class="github-button" title="github-button" target="_blank" rel="noopener" href="https://github.com/haojen/hexo-theme-Claudia" data-color-scheme="no-preference: light; light: light; dark: dark;" data-show-count="true"></a></div></div><div><span></span></div></footer><script async defer src="https://buttons.github.io/buttons.js"></script><script src="/js/jquery-3.6.1.min.js"></script><script src="/js/jquery-fancybox.min.js"></script><script src="/js/img_zoom.js"></script><script src="/js/post.js"></script></body></html>